---
export const prerender = false;
import type { User } from "@runner/api";
import { APP_NAME } from "@runner/utils";
import { getProfile } from "../clients/v1Client.ts";

const userSession = Astro.cookies.get("session");
console.log(userSession);

let profile: User | undefined;
if (userSession) {
  const res = await getProfile(
    {},
    {
      init: {
        headers: {
          cookie: `session=${userSession.value}`,
        },
      },
    },
  );

  if (res.ok) {
    profile = (await res.json()).data;
  }
}
---

<nav class="sticky top-0 z-50 border-b bg-white/90 backdrop-blur-md">
  <div
    class="mx-auto flex max-w-7xl items-center justify-between px-4 py-4 sm:px-6 lg:px-8"
  >
    <div class="flex items-center">
      <h1 class="text-2xl font-bold text-gray-900">
        <a href="/">{APP_NAME}</a>
      </h1>
    </div>
    <ul class="flex items-center space-x-4">
      <li>
        <a href="#" class="text-gray-600 hover:text-gray-900">Features</a>
      </li>
      <li><a href="#" class="text-gray-600 hover:text-gray-900">Pricing</a></li>
      <li><a href="#" class="text-gray-600 hover:text-gray-900">Support</a></li>
    </ul>
    <div>
      <a
        href="/signup"
        class="cursor-pointer rounded-md bg-black px-4 py-2 text-white hover:bg-gray-800"
        >Sign up</a
      >
      <a href="/login" class="rounded-md px-4 py-2 text-black">Log In</a>
      <span>{profile?.firstName}</span>
    </div>
  </div>
</nav>
